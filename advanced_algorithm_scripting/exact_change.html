<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <script type="text/javascript">
    function checkCashRegister(price, cash, cid) {
      var moneyFilter = 0;
      //以下两个变量是存储可能需要返回的二位数组用的
      var billArr = [];
      var itemArr = [];
      //应找零钱
      var change = Number((cash-price).toFixed(2));

      //收银台合计零钱
      var sumCid = 0;

      cid.forEach(function(val){
        sumCid += val[1]
      });
       Number(sumCid.toFixed(2));
       //情况一：应找零钱多于收银台中的零钱
      if(change > sumCid) {
        console.log('infun')
        return 'Insufficient Funds';
      }
       //情况二：应找零钱等于收银台中的零钱
      if(change == sumCid || change==0) {
        console.log('clo')
        return 'Closed';
      }
       //情况三：应找零钱等小于收银台中的零钱-开始找零
      if(change < sumCid){
         changeFun(change,cid)
      }
/********************************************************/
      function changeFun(change,cid){

        //倒叙进行，从百位数开始排查
        for(var i=cid.length-1;i>=0;i--){
          console.log('change',change)
          console.log('i',i)
          if(cid[i][1] ==0){
            continue;
          }
          //
           var x = cid[i][0];
           filterChange(x,change)
           console.log(i+':',moneyFilter)
          if(moneyFilter ==0){
            continue;
          } else if(cid[i][1]<moneyFilter){
                itemArr.push(cid[i][0],(cid[i][1]).toFixed(2));
                change -= cid[i][1];
                cid[i][1] = 0;
                console.log(i+':con1:'+itemArr)
            } else if(moneyFilter<=cid[i][1]){
              console.log(i+':con2')
                itemArr.push(cid[i][0],(moneyFilter).toFixed(2));
                change -= moneyFilter;
                cid[i][1] -= moneyFilter;
            }
            billArr.push(itemArr);
            console.log('billArr'+i+':'+billArr)
            itemArr = [];
            change = Number(change.toFixed(2));
            if(change ==0){
              console.log('finish')
               console.log(billArr)
              return billArr
            } else {
              console.log('finish1')
                changeFun(change,cid)
            }
           }
        }

        //将价格中的百十元角分，分离出来，并计算对应的部分需要找多少零钱
        function filterChange(changeType,change){
          switch(changeType) {
            case "ONE HUNDRED":
              moneyFilter = Math.floor(change / 100) * 100;
              break;
            case "TWENTY":
              moneyFilter = Math.floor(change / 20) * 20;
              break;
            case "TEN":
              moneyFilter = Math.floor(change / 10) * 10;
              break;
            case "FIVE":
              moneyFilter = Math.floor(change / 5) * 5;
              break;
            case "ONE":
              moneyFilter = Math.floor(change / 1);
              break;
            case "QUARTER":
              moneyFilter = Math.floor(change / 0.25) * 0.25;
              break;
            case "DIME":
              moneyFilter = Math.floor(change / 0.10) * 0.10;
              break;
            case "NICKEL":
              moneyFilter = Math.floor(change / 0.05) * 0.05;
              break;
            case "PENNY":
              moneyFilter = Math.floor(change / 0.01) * 0.01;
              break;
          }
        }
      }
      checkCashRegister(3.26, 100.00, [["PENNY", 1.01], ["NICKEL", 2.05], ["DIME", 3.10], ["QUARTER", 4.25], ["ONE", 90.00], ["FIVE", 55.00], ["TEN", 20.00], ["TWENTY", 60.00], ["ONE HUNDRED", 100.00]])
    </script>
  </body>
</html>
